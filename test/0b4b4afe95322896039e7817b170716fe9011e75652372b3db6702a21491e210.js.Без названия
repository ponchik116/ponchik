!function(){"use strict";function g(n,r){return C(void 0,void 0,Promise,function(){var t;return N(this,function(e){switch(e.label){case 0:return t=i(n),[4,x.httpService.post({withCredentials:!0,url:t},{rsvpStatus:r})];case 1:return[2,e.sent().data]}})})}function w(e,t,n){return e(f[t].translationKey,n)||f[t].fallback}function S(e){return(e?new Date(e):new Date(0)).getTime()}function I(t,e){function n(e){return Number.parseFloat((t/e).toFixed(1)).toString()}return 1e9<=t?""+n(1e9)+w(e,"billionShorthandIdentifier"):1e6<=t?""+n(1e6)+w(e,"millionShorthandIdentifier"):1e3<=t?""+n(1e3)+w(e,"thousandShorthandIdentifier"):t.toString()}function k(e,t){if(!e)throw new Error("missing root placeId");h(e.toString(),e.toString(),"",void 0,{eventName:"virtualEventJoinGame",ctx:o,eventJoinSessionId:t})}var r={n:function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},d:function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},x=CoreUtilities,P=React,D=r.n(P),e=ReactDOM,T=Roblox,a=r.n(T),C=function(e,o,u,l){return new(u=u||Promise)(function(n,t){function r(e){try{i(l.next(e))}catch(e){t(e)}}function a(e){try{i(l.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?n(e.value):((t=e.value)instanceof u?t:new u(function(e){e(t)})).then(r,a)}i((l=l.apply(e,o||[])).next())})},N=function(n,r){var a,i,o,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(a)throw new TypeError("Generator is already executing.");for(;u;)try{if(a=1,i&&(o=2&t[0]?i.return:t[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,t[1])).done)return o;switch(i=0,o&&(t=[2&t[0],o.value]),t[0]){case 0:case 1:o=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,i=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(o=0<(o=u.trys).length&&o[o.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!o||t[1]>o[0]&&t[1]<o[3])){u.label=t[1];break}if(6===t[0]&&u.label<o[1]){u.label=o[1],o=t;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(t);break}o[2]&&u.ops.pop(),u.trys.pop();continue}t=r.call(n,u)}catch(e){t=[6,e],i=0}finally{a=o=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},t=T.EnvironmentUrls.apiGatewayUrl||"https://apis.roblox.com",d=T.EnvironmentUrls.gamesApi,i=(T.EnvironmentUrls.thumbnailsApi,function(e){return t+"/virtual-events/v1/virtual-events/"+e+"/rsvps"}),U=function(e){return t+"/virtual-events/v1/virtual-events/"+e+"/rsvps/counters"},m=function(e){return t+"/virtual-events/v1/universes/"+e+"/virtual-events?fromUtc="+(new Date).toISOString()},F="going",M="notGoing",n=ReactUtilities,R=ReactStyleGuide,o="virtualEvents",u="expDetailsPage",l="virtualEventJoined",s="eventDetailsPageVisit",c="virtualEventRSVP",v="virtualEventImpression",V={sendVirtualEventImpressionFromExperienceDetailsPageEvent:function(e,t){a().EventStream.SendEventWithTarget(v,o,{virtualEventId:e,universeId:t,channel:u},a().EventStream.TargetTypes.WWW)},sendVirtualEventJoinedFromExperienceDetailsPageEvent:function(e,t,n,r){a().EventStream.SendEventWithTarget(l,o,{virtualEventId:e,universeId:t,"SD.gamePlayFromEventDetails.ID":n,"SD.gamePlayFromEventDetails.CT":Date.now(),channel:u,attendanceCount:r},a().EventStream.TargetTypes.WWW)},sendEventDetailsPageVisitFromExpDetailsEvent:function(e,t){a().EventStream.SendEventWithTarget(s,o,{virtualEventId:e,universeId:t,channel:u},a().EventStream.TargetTypes.WWW)},sendVirtualEventRSVPFromExpDetailsEvent:function(e,t,n,r){a().EventStream.SendEventWithTarget(c,o,{virtualEventId:e,universeId:t,channel:u,status:n,attendanceCount:r},a().EventStream.TargetTypes.WWW)}},f={millionShorthandIdentifier:{translationKey:"millionShorthandIdentifier",fallback:"M"},billionShorthandIdentifier:{translationKey:"billionShorthandIdentifier",fallback:"B"},thousandShorthandIdentifier:{translationKey:"thousandShorthandIdentifier",fallback:"K"},eventsTitle:{translationKey:"EventsListTitle",fallback:"Events"},seeMore:{translationKey:"SeeMore",fallback:"See More"},joinEvent:{translationKey:"JoinEvent",fallback:"Join Event"},unfollowEvent:{translationKey:"UnfollowEvent",fallback:"Unfollow Event"},NotifyMe:{translationKey:"NotifyMe",fallback:"Notify Me"},networkError:{translationKey:"NetworkError",fallback:"Something went wrong. Please try again later"}},W="UPCOMING",A="LIVE",K="PAST",h=T.PlayButton.launchGame,p={common:["CommonUI.Features"],feature:"Feature.VirtualEvents"},O=function(e,o,u,l){return new(u=u||Promise)(function(n,t){function r(e){try{i(l.next(e))}catch(e){t(e)}}function a(e){try{i(l.throw(e))}catch(e){t(e)}}function i(e){var t;e.done?n(e.value):((t=e.value)instanceof u?t:new u(function(e){e(t)})).then(r,a)}i((l=l.apply(e,o||[])).next())})},G=function(n,r){var a,i,o,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(a)throw new TypeError("Generator is already executing.");for(;u;)try{if(a=1,i&&(o=2&t[0]?i.return:t[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,t[1])).done)return o;switch(i=0,o&&(t=[2&t[0],o.value]),t[0]){case 0:case 1:o=t;break;case 4:return u.label++,{value:t[1],done:!1};case 5:u.label++,i=t[1],t=[0];continue;case 7:t=u.ops.pop(),u.trys.pop();continue;default:if(!(o=0<(o=u.trys).length&&o[o.length-1])&&(6===t[0]||2===t[0])){u=0;continue}if(3===t[0]&&(!o||t[1]>o[0]&&t[1]<o[3])){u.label=t[1];break}if(6===t[0]&&u.label<o[1]){u.label=o[1],o=t;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(t);break}o[2]&&u.ops.pop(),u.trys.pop();continue}t=r.call(n,u)}catch(e){t=[6,e],i=0}finally{a=o=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},b=(0,R.createSystemFeedback)(),j=b[0],J=b[1],E=(0,n.withTranslations)(function(e){var t,r=e.eventItem,n=e.universeDetails,a=e.playabilityStatus,i=e.translate,o=(0,P.useState)(!0),u=o[0],l=o[1],s=(0,P.useState)(0),c=s[0],v=s[1],f=(0,P.useState)(!1),d=f[0],m=f[1],h=(y=S(r.eventTime.startUtc),t=S(r.eventTime.endUtc),(y>Date.now()?W:t<Date.now()?K:A)===A),e=(0,P.useCallback)(function(){return w(i,h?"joinEvent":d?"unfollowEvent":"NotifyMe")},[h,i,d]),o=(0,P.useCallback)(function(){return h?"btn-growth-md":d?"btn-control-md":"btn-primary-md"},[h,d]),p=(0,P.useCallback)(function(e){e.preventDefault(),e.stopPropagation();var t=x.uuidService.generateRandomUuid();V.sendVirtualEventJoinedFromExperienceDetailsPageEvent(r.id,r.universeId,t,c);try{null!==n&&k(null==n?void 0:n.rootPlaceId,t)}catch(e){}},[r.id,r.universeId,n,c]),b=(0,P.useCallback)(function(t){return O(void 0,void 0,void 0,function(){return G(this,function(e){switch(e.label){case 0:t.preventDefault(),t.stopPropagation(),V.sendVirtualEventRSVPFromExpDetailsEvent(r.id,r.universeId,F,c),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,g(r.id,F)];case 2:return e.sent(),v(function(e){return e+1}),m(!0),[3,4];case 3:return e.sent(),J.warning(w(i,"networkError")),[3,4];case 4:return[2]}})})},[r.id,r.universeId,c,i]),E=(0,P.useCallback)(function(t){return O(void 0,void 0,void 0,function(){return G(this,function(e){switch(e.label){case 0:t.preventDefault(),t.stopPropagation(),V.sendVirtualEventRSVPFromExpDetailsEvent(r.id,r.universeId,M,c),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,g(r.id,M)];case 2:return e.sent(),v(function(e){return Math.max(e-1,0)}),m(!1),[3,4];case 3:return e.sent(),J.warning(w(i,"networkError")),[3,4];case 4:return[2]}})})},[r.id,r.universeId,c,i]),s=(0,P.useMemo)(function(){return"Playable"===a},[a]),f=(0,P.useCallback)(function(){return h?p:d?E:b},[h,p,b,E,d]),y=(0,P.useCallback)(function(){V.sendEventDetailsPageVisitFromExpDetailsEvent(r.id,r.universeId)},[r.id,r.universeId]);return(0,P.useEffect)(function(){V.sendVirtualEventImpressionFromExperienceDetailsPageEvent(r.id,r.universeId)},[r.id,r.universeId]),(0,P.useEffect)(function(){m(r.userRsvpStatus===F),O(void 0,void 0,void 0,function(){var t;return G(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,(n=r.id,C(void 0,void 0,Promise,function(){var t;return N(this,function(e){switch(e.label){case 0:return t=U(n),[4,x.httpService.get({withCredentials:!0,url:t})];case 1:return[2,e.sent().data]}})}))];case 1:return t=e.sent(),v(t.counters.going),l(!1),[3,3];case 2:return e.sent(),v(0),l(!1),[3,3];case 3:return[2]}var n})})},[r.id,r.universeId,r.userRsvpStatus,h]),D().createElement("li",{className:"stack-row"},D().createElement(R.Link,{className:"clickable-event-list-item","aria-label":r.title,onClick:y,url:"https://"+window.location.hostname+"/events/"+r.id},D().createElement("div",{className:"clickable-event-list-item-contents"},D().createElement("div",{className:"event-title font-header-2"},r.title),D().createElement("div",{className:"event-subtitle-container"},D().createElement("div",{className:"event-subtitle-item small-oneline text"},(t=S(r.eventTime.startUtc),y=(new T.Intl).locale,new Date(t).toLocaleString(y,{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"numeric"}).toUpperCase())),!u&&(0<c||0<n.playing)&&D().createElement("div",{className:"event-subtitle-item small-oneline text"},"â€¢"),0<c&&D().createElement(D().Fragment,null,D().createElement("div",{className:"icon-override favorited-icon"}),D().createElement("div",{className:"event-subtitle-item small-oneline text"},I(c,i))),h&&0<n.playing&&D().createElement(D().Fragment,null,D().createElement("div",{className:"icon-override player-icon"}),D().createElement("div",{className:"event-subtitle-item small-oneline text"},I(n.playing,i)))),D().createElement("div",{className:"event-description-container"},D().createElement("p",{className:"event-description small text"},r.description)),D().createElement("button",{type:"button",disabled:!s&&h,"aria-label":!s&&h?a:e(),onClick:f(),className:"notify-button btn-full-width "+o()},e())),D().createElement(j,null)))},p),y=T.PlayButton.usePlayabilityStatus,L=(0,n.withTranslations)(function(e){var t=e.eventList,n=e.universeDetails,r=e.translate,a=(0,P.useState)(0),i=a[0],o=a[1],e=y(n.id.toString()),u=e[0],a=(e[1],(0,P.useCallback)(function(){o(function(e){return e+1})},[])),l=(0,P.useMemo)(function(){return t.filter(function(e){return S(e.eventTime.endUtc)>(new Date).getTime()})},[t]),e=(0,P.useMemo)(function(){return l.length>2+2*i},[i,l]);return l.length<=0?D().createElement("div",null):D().createElement(D().Fragment,null,D().createElement("div",{className:"container-header"},D().createElement("h2",null,w(r,"eventsTitle"))),D().createElement("div",{className:"stack"},D().createElement("ul",{className:"stack-list"},l.sort(function(e,t){return S(e.eventTime.startUtc)<S(t.eventTime.startUtc)?-1:1}).slice(0,2+2*i).map(function(e){return D().createElement(E,{key:e.id,eventItem:e,universeDetails:n,playabilityStatus:u})}))),e&&D().createElement("button",{type:"button","aria-label":w(r,"seeMore"),onClick:a,className:"notify-button btn-full-width btn-control-md"},w(r,"seeMore")))},p);function B(e,t,n,r,a,i,o){try{var u=e[i](o),l=u.value}catch(e){return void n(e)}u.done?t(l):Promise.resolve(l).then(r,a)}function _(u){return function(){var e=this,o=arguments;return new Promise(function(t,n){var r=u.apply(e,o);function a(e){B(r,t,n,a,i,"next",e)}function i(e){B(r,t,n,a,i,"throw",e)}a(void 0)})}}function $(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,i=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return q(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return q(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function q(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var z=window.Roblox||{};function H(){var a=z.GamePassJSData.PlaceID,e=$((0,P.useState)(null),2),t=e[0],i=e[1],n=(r=$((0,P.useState)([]),2))[0],o=r[1],r=(e=$((0,P.useState)({}),2))[0],u=e[1],l=(e=$((0,P.useState)(!1),2))[0],s=e[1],c=(0,P.useRef)(null),v="CreatorSuccess.VirtualEvents",f=(0,P.useCallback)(function(){T.ExperimentationService.logLayerExposure(v),s(!0)},[]);return(0,P.useEffect)(function(){if(T.CurrentUser.isAuthenticated){var e=c.current,t=new IntersectionObserver(function(e){$(e,1)[0].isIntersecting&&0<n.length&&!l&&f()},{root:null,rootMargin:"0px",threshold:.3});return e&&t.observe(e),function(){e&&t.unobserve(e)}}},[c,n,l,f]),(0,P.useEffect)(function(){var n=function(){var e=_(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.ExperimentationService.getAllValuesForLayer(v);case 2:return t=e.sent,e.abrupt("return",!0===t.virtualEventsMVPEnabled);case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),r=function(){var e=_(regeneratorRuntime.mark(function e(){var t,n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,function(t){return C(void 0,void 0,Promise,function(){return N(this,function(e){switch(e.label){case 0:return[4,x.httpService.get({url:d+"/v1/games/multiget-place-details?placeIds="+t,withCredentials:!0,timeout:1e4})];case 1:return[2,e.sent().data[0]]}})})}(a);case 2:return t=e.sent,e.next=5,function(n){return C(void 0,void 0,Promise,function(){var t;return N(this,function(e){switch(e.label){case 0:return t=m(n),[4,x.httpService.get({url:t,withCredentials:!0})];case 1:return[2,e.sent().data.data]}})})}(null==t?void 0:t.universeId);case 5:if(0<(null==(n=e.sent)?void 0:n.length))return e.next=9,function(t){return C(void 0,void 0,Promise,function(){return N(this,function(e){switch(e.label){case 0:return[4,x.httpService.get({url:d+"/v1/games",timeout:1e4,withCredentials:!0},{universeIds:t})];case 1:return[2,e.sent().data.data[0]]}})})}([null==t?void 0:t.universeId]);e.next=11;break;case 9:r=e.sent,u(r);case 11:o(n);case 12:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();(function(){var e=_(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(T.CurrentUser.isAuthenticated){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,n();case 4:t=e.sent,i(t),r();case 7:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}})()()},[a]),0<(null==n?void 0:n.length)?D().createElement("div",{ref:c,className:"virtual-event-game-details-container"},!0===t&&D().createElement(L,{eventList:n,universeDetails:r})):D().createElement("div",null)}var Q="game-events-container";(0,x.ready)(function(){document.getElementById(Q)&&(0,e.render)(D().createElement(H,null),document.getElementById(Q))})}();
//# sourceMappingURL=https://js.rbxcdn.com/2961f89c0c1bed44cca1194e2e56f766-gameDetailsVirtualEventsSection.bundle.min.js.map

/* Bundle detector */
window.Roblox && window.Roblox.BundleDetector && window.Roblox.BundleDetector.bundleDetected("GameDetailsVirtualEventsSection");